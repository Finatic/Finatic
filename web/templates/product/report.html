{%extends 'base.html'%}
{%block title %}
Portfolio Optimiser
{%endblock%}
{%block content %}
{%load static%}
<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <!-- Bootstrap CSS CDN -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css"
        integrity="sha384-9gVQ4dYFwwWSjIDZnLEWnxCjeSWFphJiwGPXr1jddIhOegiu1FwO5qRGvFXOdJZ4" crossorigin="anonymous">
    <!-- Our Custom CSS -->
    <link rel="stylesheet" href="{%static 'css/style5.css'%}">
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>

    <!-- Font Awesome JS -->
    <script defer src="https://use.fontawesome.com/releases/v5.0.13/js/solid.js"
        integrity="sha384-tzzSw1/Vo+0N5UhStP3bvwWPq+uvzCMfrN1fEFe+xBmv1C/AtVX5K0uZtmcHitFZ"
        crossorigin="anonymous"></script>
    <script defer src="https://use.fontawesome.com/releases/v5.0.13/js/fontawesome.js"
        integrity="sha384-6OIrr52G08NpOFSZdxxz1xdNSndlD4vdcf/q2myIUVO0VsqaGHJsB0RaBE01VTOY"
        crossorigin="anonymous"></script>

</head>

<body>

    <div class="wrapper">
        <!-- Sidebar Holder -->
        <nav id="sidebar">
            <div class="sidebar-header">
                <h3>Dashboard</h3>
            </div>

            <ul class="list-unstyled components">
                <p>Portfolio Analyzer</p>
                <li>
                    <a href="#homeSubmenu" data-toggle="collapse" aria-expanded="false" class="dropdown-toggle">Home</a>
                    <ul class="collapse list-unstyled" id="homeSubmenu">
                        <li>
                            <a href="#">Home 1</a>
                        </li>
                        <li>
                            <a href="#">Home 2</a>
                        </li>
                        <li>
                            <a href="#">Home 3</a>
                        </li>
                    </ul>
                </li>
                <li>
                    <a href="#">Portfolio Statistics</a>
                </li>
                <li>
                    <a href="#">Historical Analysis</a>
                </li>
                <li>
                    <a href="#">Optimization</a>
                </li>
                <li>
                    <a href="#">Predictive Analysis</a>
                </li>
            </ul>


        </nav>

        <!-- Page Content Holder -->
        <div id="content">

            <nav class="navbar navbar-expand-lg navbar-light bg-light">
                <div class="container-fluid">

                    <button type="button" id="sidebarCollapse" class="navbar-btn">
                        <span></span>
                        <span></span>
                        <span></span>
                    </button>

                </div>
            </nav>
            <div>
                <h2 class="text-info h1-responsive  font-weight-bold pb-2">Report</h2>
                <br>
                <div id="table_diva"></div>
                <br>
                <div>
                    <p> Current Value = {{Current_Value}} </p>
                    <p> Invested Value = {{Invested_value}} </p>
                    <p> Profit / Loss = {{Profit_loss}} </p>
                </div>
                <canvas id="myCharta" width="70" height="20" class="col-sm-6"></canvas>
                <canvas id="myChartb" width="70" height="20" class="col-sm-6"></canvas>
                <br>
                <div id="table_divb"></div>
                <h6> Original Portfolio Statistics--></h6>
                <p>Expected annual return = {{percent_ret1}} </p>
                <p>Annual volatility/standard deviation/risk = {{percent_vols1}}</p>
                <p>Annual variance = {{percent_var1}}</p>

                <h6> Optimized Portfolio Statistics--></h6>
                <p>Expected annual return = {{percent_ret2}} </p>
                <p>Annual volatility/standard deviation/risk = {{percent_vols2}}</p>
                <p>Annual variance = {{percent_var2}}</p>
                <br>
                <div id="table_divc"></div>
            </div>


        </div>

        <!-- jQuery CDN - Slim version (=without AJAX) -->
        <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
            integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
            crossorigin="anonymous"></script>
        <!-- Popper.JS -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js"
            integrity="sha384-cs/chFZiN24E4KMATLdqdvsezGxaGsi4hLGOzlXwp5UZB1LY//20VyM2taTB4QvJ"
            crossorigin="anonymous"></script>
        <!-- Bootstrap JS -->
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js"
            integrity="sha384-uefMccjFJAIv6A+rW+L4AHf99KvxDjWSu1z9VI8SKNVmz4sk7buKt/6v9KI65qnm"
            crossorigin="anonymous"></script>

        <script type="text/javascript">
            $(document).ready(function () {
                $('#sidebarCollapse').on('click', function () {
                    $('#sidebar').toggleClass('active');
                    $(this).toggleClass('active');
                });
            });
        </script>
        <!---------------------------Pie Chart---------------------------------------------->
        <script>
            var sect = [[]];
            var sect = JSON.parse("{{sector|escapejs}}");
            console.log(sect)
            var data = {
                datasets: [{
                    backgroundColor: ['#67f581', '#1abbde', '#fffe2b', '#345de3', '#0033da', '#5ca06d', '#27fa3a', '#07d58f', '#ee2d80', '#5bc0de'],
                    data: sect['1']
                }],

                // These labels appear in the legend and in the tooltips when hovering different arcs
                labels: sect['2']
            };
            var ctx = document.getElementById("myCharta");
            var myPieChart = new Chart(ctx, {
                type: 'doughnut',
                data: data,
                //options: options
            });
        </script>

        <!----------------------------Pie Chart--b------------------------------------------>
        <script>
            var ind = [[]];
            var ind = JSON.parse("{{industry|escapejs}}");
            console.log(sect)
            var data = {
                datasets: [{
                    backgroundColor: ['#67f581', '#1abbde', '#fffe2b', '#345de3', '#0033da', '#5ca06d', '#27fa3a', '#07d58f', '#ee2d80', '#5bc0de'],
                    data: ind['1']
                }],

                // These labels appear in the legend and in the tooltips when hovering different arcs
                labels: ind['2']
            };
            var ctx = document.getElementById("myChartb");
            var myPieChart = new Chart(ctx, {
                type: 'doughnut',
                data: data,
                //options: options
            });
        </script>

        <!---------------------------Stat Table--------------------------------------------->
        <script type="text/javascript">
            google.charts.load('current', { 'packages': ['table'] });
            google.charts.setOnLoadCallback(drawTable);

            function drawTable() {
                var arr = [[]];
                var arr = JSON.parse("{{paradict|escapejs}}");
                var data = new google.visualization.DataTable();

                data.addColumn('string', 'Company');
                data.addColumn('number', 'Quantity');
                data.addColumn('number', 'Buy Price');
                data.addColumn('number', 'Current Price');
                data.addColumn('number', 'Buy Value');
                data.addColumn('number', 'Current Value');
                data.addColumn('number', 'Profit / Loss');
                data.addColumn('number', 'Weightage');

                data.addRows(
                    arr['1'],
                );

                var table = new google.visualization.Table(document.getElementById('table_diva'));

                table.draw(data, { showRowNumber: true, width: '100%', height: '100%' });
            }
        </script>
        <!------------------------Optimized Table------------------------------------------>
        <script type="text/javascript">
            google.charts.load('current', { 'packages': ['table'] });
            google.charts.setOnLoadCallback(drawTable);

            function drawTable() {
                var arr = [[]];
                var arr = JSON.parse("{{optdict|escapejs}}");
                var data = new google.visualization.DataTable();

                data.addColumn('string', 'Company');
                data.addColumn('number', 'Quantity');
                data.addColumn('number', 'Buy Price');
                data.addColumn('number', 'Current Price');
                data.addColumn('number', 'Buy Value');
                data.addColumn('number', 'Current Value');
                data.addColumn('number', 'Profit / Loss');
                data.addColumn('number', 'Weightage');
                data.addColumn('number', 'Optimized Weightage');
                data.addColumn('number', 'Optimized Value');
                data.addColumn('number', 'Optimized Quantity');

                data.addRows(
                    arr['1'],
                );

                var table = new google.visualization.Table(document.getElementById('table_divb'));

                table.draw(data, { showRowNumber: true, width: '100%', height: '100%' });
            }
        </script>
        <!------------------------Individual PE list---------------------------------->
        <script type="text/javascript">
            google.charts.load('current', { 'packages': ['table'] });
            google.charts.setOnLoadCallback(drawTable);

            function drawTable() {
                var arr = [[]];
                var arr = JSON.parse("{{pe|escapejs}}");
                console.log(arr)
                var data = new google.visualization.DataTable();

                data.addColumn('string', 'Company');
                data.addColumn('number', 'Quantity');
                data.addColumn('number', 'Buy Price');
                data.addColumn('number', 'Current Price');
                data.addColumn('number', 'Buy Value');
                data.addColumn('number', 'Current Value');
                data.addColumn('number', 'Profit / Loss');
                data.addColumn('number', 'Weightage');
                data.addColumn('number', 'Volume');
                data.addColumn('number', 'Market Cap');
                data.addColumn('number', 'PE Ratio');
                data.addColumn('number', 'EPS(TTM)');
                data.addColumn('string', 'Sector');
                data.addColumn('number', 'Last');
                data.addColumn('number', 'Beta');
                data.addColumn('number', 'Basic EPS(FY)');
                data.addColumn('number', 'EBITDA(TTM)');
                data.addColumn('number', 'Goodwill');
                data.addColumn('string', 'Industry');
                data.addColumn('number', 'Last Year Revenue');
                data.addColumn('number', 'Net Debt');
                data.addColumn('number', 'Net Income');
                data.addColumn('number', 'Net margin');
                data.addColumn('number', 'Quick Ratio');
                data.addColumn('number', 'ROA');
                data.addColumn('number', 'ROE');
                data.addColumn('number', 'ROIC');
                data.addColumn('number', 'Revenue per Employee');
                data.addColumn('number', 'Total Debt');
                data.addColumn('number', 'Total Revenue');
                data.addColumn('number', 'YTD Perf');
                data.addColumn('number', 'Yearly Performance');
                data.addColumn('number', 'No. of Employees');
                data.addColumn('number', 'Gross margin');
                data.addColumn('number', 'Gross Profit(FY)');
                data.addColumn('number', 'Gross Profit(MRQ)');
                data.addColumn('number', 'Monthly Perf');
                data.addColumn('number', 'Total Assets (MRQ)');
                data.addColumn('number', 'Total Current Assets (MRQ)');
                data.addColumn('number', 'Total Shares Outstanding ');


                data.addRows(
                    arr['1'],
                );

                var table = new google.visualization.Table(document.getElementById('table_divc'));

                table.draw(data, { showRowNumber: true, width: '100%', height: '100%' });
            }
        </script>

</body>

</html>
{%endblock%}